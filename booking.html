<!DOCTYPE html>
<html lang="en">


<head>

  <meta charset = "UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  
  <link rel="stylesheet" type="text/css" href="newstyle.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">


<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-database.js"></script>

<script>
  // Replace with your own configuration details
const firebaseConfig = {
 apiKey: "AIzaSyDf2HfoxicUgf7P2n9rTDBF7XT7CwTCpbw",
 authDomain: "mediconnect-apk-6739f.firebaseapp.com",
 projectId: "mediconnect-apk-6739f", 
 messagingSenderId: "289810283860",
 storageBucket: "gs://mediconnect-apk-6739f.appspot.com",
 databaseURL: "https://mediconnect-apk-6739f-default-rtdb.firebaseio.com/",
 appId: "1:289810283860:android:90178fefc8100e1922dcc1"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
</script>

</head>


<nav class="navbar navbar-expand-md">
	<a class="navbar-brand" href="#" id="Home">DIGITAL HEALTH HUB</a>
	<button class="navbar-toggler navbar-dark" type="button" data-toggle="collapse" data-target="#main-navigation">
		<span class="navbar-toggler-icon"></span>
	</button>
	<div class="collapse navbar-collapse" id="main-navigation">
		<ul class="navbar-nav">
			<li class="nav-item">
				<a class="nav-link" href="patient.html">Return to Patient</a>
			</li>
		</ul>
	</div>
</nav>



<div class="columnN right" >
    <img class="card-img-top " src="PAT1.jpeg" height="750vh" alt="Card image">
          <div class="card-body">
        <h4 class="card-title"></h4>
        <p class="card-text"></p>
  </div>
</div>

<div class="container" style="text-align: center;">
    <h1 style="background-color: rgb(234, 232, 232); border-color: rgb(147, 147, 234); border-width: thick;" >BOOK AN APPOINTMENT</h1>
    <br>
    <form id="appointmentForm">
      <label for="dateInput">DATE:</label>
      <input type="date" id="dateInput" required  style="background-color: rgb(234, 232, 232); border-color: rgb(147, 147, 234); border-width: thick;" ><br>

      <br>
      <label for="timeInput">TIME:</label>
      <input type="time" id="timeInput" required  style="background-color: rgb(234, 232, 232); border-color: rgb(147, 147, 234); border-width: thick;" ><br>

      <br>

      <label for="departmentInput">DEPARTMENT:</label>
<select id="departmentInput" required style="background-color: rgb(234, 232, 232); border-color: rgb(147, 147, 234); border-width: thick;" >
  <option value="General Practitioner">General Practitioner</option>
  <option value="Orthotist">Orthotist</option>
  <option value="Physiotherapist">Physiotherapist</option>
  <option value="Audiologist">Audiologist</option>
  <option value="Chiropractor">Chiropractor</option>
  <option value="Psychologist">Psychologist</option>
  <option value="Dentist">Dentist</option>
  <option value="Dietitian">Dietitian</option>
</select><br>
<br><br>
      <button type="submit" style="background-color: rgb(234, 232, 232); border-color: rgb(147, 147, 234); border-width: thick;" >Book Appointment</button>
    </form>
  </div>

  <br><br>

<footer class="page-footer">
  <div class="rowwww">
    <div class="columnnn" style="align-content: center;">
        <img src="discovery.png" alt="" style="width: 80%;  margin-left: 30%;">
    </div>
    <div class="columnnn"  style="align-content: center;">
        <img src="Bankmed-1.png" alt="" style="width: 60%; margin-left: 20%;">
    </div>
    <div class="columnnn" style="align-content: center;">
        <img src="GEMS23.png" alt="" style="width: 80%; margin-left: 20%;">
    </div>
    <div class="columnnn" style="align-content: center;">
        <img src="Momentum33.png" alt="" style="width: 60%; margin-left: 20%;">
    </div>
  </div>
  <br><br>
  <p class="text-uppercase font-weight-bold">Stay In Touch With DigitalHealthHub Â© 2020 Copyright: MyWebsite.com</p>
  </footer>

<script src="newjs.js"></script>


<!-- ... (Your existing HTML code) ... -->

<script>
    var appointmentForm = document.getElementById("appointmentForm");
    appointmentForm.addEventListener("submit", function (event) {
      event.preventDefault();
      var date = document.getElementById("dateInput").value;
      var time = document.getElementById("timeInput").value;
      var department = document.getElementById("departmentInput").value;
  
      // Add code to validate the date format (optional).
      if (!isValidDateFormat(date)) {
        alert("Invalid date format. Please use yyyy-mm-dd.");
        return;
      }
  
      // Add code to validate the time format (optional).
      if (!isValidTimeFormat(time)) {
        alert("Invalid time format. Please use hh:mm.");
        return;
      }
  
      // Add code to check if the time is within working hours (9 am - 5 pm).
      if (!isWithinWorkingHours(time)) {
        alert("Appointments are only available between 9 am and 5 pm.");
        return;
      }
  
      // Check appointment availability in the database.
      checkAppointmentAvailability(date, time, department);
    });
  
    // Function to validate the date format (optional).
    function isValidDateFormat(date) {
      const datePattern = /^\d{4}-\d{2}-\d{2}$/;
      return datePattern.test(date);
    }
  
    // Function to validate the time format (optional).
    function isValidTimeFormat(time) {
      const timePattern = /^\d{2}:\d{2}$/;
      return timePattern.test(time);
    }
  
    // Function to check if the time is within working hours (9 am - 5 pm).
    function isWithinWorkingHours(time) {
      const appointmentTime = new Date("2000-01-01 " + time);
      const workingHoursStart = new Date("2000-01-01 09:00");
      const workingHoursEnd = new Date("2000-01-01 17:00");
      return appointmentTime >= workingHoursStart && appointmentTime <= workingHoursEnd;
    }
  
    // Function to check appointment availability in the database.
    function checkAppointmentAvailability(date, time, department) {
      var database = firebase.database();
      var appointmentsRef = database.ref("appointments");
  
      // Check if the appointment already exists in the database.
      appointmentsRef
        .orderByChild("date")
        .equalTo(date)
        .once("value", function (snapshot) {
          var appointments = snapshot.val();
  
          if (appointments) {
            var existingAppointment = Object.values(appointments).find(
              (appt) => appt.time === time && appt.department === department
            );
  
            if (existingAppointment) {
              alert("Appointment already booked for the selected date, time, and department.");
            } else {
              // If appointment is valid and available, write to the database.
              var newAppointmentRef = appointmentsRef.push();
              newAppointmentRef.set({
                date: date,
                time: time,
                department: department,
              });
              alert("Appointment booked successfully!");
            }
          } else {
            // If no appointments found for the selected date, write to the database.
            var newAppointmentRef = appointmentsRef.push();
            newAppointmentRef.set({
              date: date,
              time: time,
              department: department,
            });
            alert("Appointment booked successfully!");
          }
        });
    }
  </script>
  




</html>